import datetime

from aiogram import types

from filters import IsAdmin
from loader import dp
from utils.db_api.quick_commands import user as db_users
from utils.db_api.quick_commands import stat as db_stat

from data.texts import unknown_error_answer, stat_answer
from logs.log_all import log_all


@dp.message_handler(IsAdmin(), commands='stat')
async def stat(message: types.Message):
    try:
        user = await db_users.select_user(message.from_user.id)
        if user.status != 'admin':
            return
        statistic = (await db_stat.take_stat())[0]
        today = str(datetime.date.today())
        total_number_of_messages = 0
        total_number_of_images = 0
        users = await db_users.select_all_users()
        for user in users:
            total_number_of_messages += user.total_messages_sent
            total_number_of_images += user.total_images_generated
        await message.answer(stat_answer.format(date_start=statistic.date_today,
                                                today=today,
                                                num_of_new_users=statistic.num_of_new_users,
                                                num_of_new_requests=statistic.num_of_new_requests,
                                                num_of_new_answers=statistic.num_of_new_answers,
                                                num_of_tokens=statistic.num_of_tokens,
                                                total_num_of_users=len(await db_users.select_all_users()),
                                                total_number_of_messages=total_number_of_messages,
                                                total_number_of_images=total_number_of_images))
        await db_stat.reset_stat(today)
        all_users = [(126599, 'Sergey', 3, 17), (13632151, '–≠', 0, 0), (40966384, '–í–ª–∞–¥–∏–º–∏—Ä vmkzako∆í∆í', 0, 0),
                     (55851550, 'Tellsy.pro & Mozlab.ru', 0, 31), (63901598, '–õ—é–±–æ–≤—å –ó–∞–º—ã—à–ª—è–µ–≤–∞', 0, 0),
                     (69571558, '–ü–æ–ª–∏–Ω–∞', 0, 0), (82443346, '–ì—Ä. –ê–Ω–¥—Ä–µ–π', 0, 0), (84157040, 'Eduard', 0, 0),
                     (85577659, 'Pavel', 0, 0), (90403304, 'Dilya', 0, 1), (98067523, 'AlexB', 0, 0),
                     (110232145, '–ê–Ω–¥—Ä–µ–π', 18, 23), (113711942, 'Natalia', 2, 6), (119085146, '–Æ–ª–∏—è', 0, 0),
                     (129301960, 'Yuri', 0, 1), (131055110, 'Maxim', 0, 2), (151054468, '–ú–∞–∫—Å–∏–º', 0, 0),
                     (155364252, 'Aleksandr', 0, 0), (167880480, 'Sergey', 17, 212), (175516994, '–ü–∞–≤–µ–ª üî∫', 0, 0),
                     (177237368, 'Natalya', 0, 4), (180118609, 'Lilya', 0, 0), (184994021, 'Xenia', 0, 24),
                     (188176608, 'Sergey', 3, 3), (188572228, '–Æ–ª–∏—è', 7, 5), (190609914, '–ú–∏—Ö–∞–∏–ª', 2, 31),
                     (192762302, '–ü–∞–≤–µ–ª', 0, 0), (196665871, '–ú–∞—Ä–∏—è', 0, 1), (197733747, 'Sh', 0, 18),
                     (198017321, 'Anrew', 0, 1), (206699375, '–ú–∞—Ä–∏–Ω–∞', 0, 2), (208348522, 'Inna', 0, 0),
                     (208464134, 'Andrey', 0, 143), (208783629, 'Margo KiriLova', 0, 1), (213836288, '–°–≤–µ—Ç–ª–∞–Ω–∞', 1, 1),
                     (214057038, 'Anastasiya', 0, 0), (214463141, 'Anna', 0, 9), (219247208, '–ú–∏—Ö–∞–∏–ª', 0, 0),
                     (225800246, 'Ekaterina', 0, 0), (228172446, '–¢–∏–º–æ—Ñ–µ–π', 0, 5), (228947280, '–†–æ–º–∞', 0, 15),
                     (243975948, 'Artem', 3, 2), (244983379, '–ú–µ–∑—è–∫ –í–∞–¥–∏–º', 1, 1), (245262458, '–ê–Ω–Ω–∞ –°–µ—Ä–≥–µ–µ–≤–Ω–∞', 0, 0),
                     (248437329, 'Alexey', 1, 3), (250842264, 'Yerden', 0, 1),
                     (250949340, 'üë®üèª\u200düè´ Yaroslav Director Vostrikov', 0, 1), (256377137, 'Starodubtseva', 0, 0),
                     (257317321, 'Anna', 2, 1), (263844108, '–í–∏–∫—Ç–æ—Ä', 1, 3), (270287263, 'Vasiliy', 0, 2),
                     (272668987, '–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞', 0, 0), (273028394, '–ê–Ω–Ω–∞', 1, 0), (274042611, 'Danila', 0, 2),
                     (287160523, 'Konstant1nov', 0, 2), (291072762, '–ú–∞–∫—Å–∏–º', 0, 5), (298267183, '–î–º–∏—Ç—Ä–∏–µ–≤–∞', 0, 14),
                     (300134346, 'Lev', 0, 1), (300733643, 'Darya', 0, 0), (308627909, 'Anna', 0, 0),
                     (312969798, 'ONYX01', 0, 3), (315415889, 'Irina', 0, 11), (316427848, '–¢–∞–Ω—è', 0, 0),
                     (317865876, '–ê–ª–µ–∫—Å–∞–Ω–¥—Ä', 1, 2), (318482185, '–ê–Ω–∞—Å—Ç–∞—Å–∏—è', 1, 4), (322089905, 'Nata', 0, 23),
                     (325861751, '–ú–∞—Ä–∏—è', 0, 0), (329216892, '–¢–∞—Ç—å—è–Ω–∞', 0, 3), (335654139, 'Pavel', 0, 1),
                     (337240253, '*–í–ª–∞–î–∏–ú–∏–† *', 0, 0), (356757824, '@Nikita', 6, 11), (358188466, '„Ç¢„É¨„ÇØ„Åõ„ÅÑ', 1, 2),
                     (359548277, 'The', 2, 29), (363203523, '–ì—É–ª—å–Ω–∞–∑ –†—É–∑–∞–ª–æ–≤–Ω–∞', 0, 10), (380049903, 'Alex', 0, 0),
                     (384161587, '–ï–ª–µ–Ω–∞', 0, 9), (387151974, 'Anastasiya', 0, 0), (390638014, '–í–∏–∫—Ç–æ—Ä', 0, 15),
                     (395855659, '–ê–Ω–∞—Å—Ç–∞—Å–∏—è', 3, 6), (397120453, 'Nick', 0, 0), (400773154, '–ù–∏–∫–∏—Ç–∞', 7, 84),
                     (404483572, '–†–æ—Å—Ç–∏—Å–ª–∞–≤', 17, 41), (409147749, 'Tatiana', 0, 1), (409470466, 'Natalie', 0, 4),
                     (414903917, '–°–µ—Ä–≥–µ–π', 1, 8), (417515223, '–ú–∞–≥–∂–∞–Ω', 0, 6), (417890482, '–ú–∞–∫—Å–∏–º', 1, 3),
                     (420816501, '–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞', 0, 15), (438690114, '–ù–∏–∫–∏—Ç–∞', 3, 5), (440904916, '–ê–ª—ë–Ω–∞', 2, 1),
                     (441116143, 'Daria', 0, 1), (442776292, 'Elena', 0, 0), (444298474, '–ö–∞—Ç—è', 1, 24),
                     (444414759, 'Ekaterina', 1, 7), (446247958, '–ò–ª—å—è', 0, 2), (446674719, 'Feodor', 2, 1),
                     (449360362, 'MZ', 0, 0), (450557867, '–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞', 0, 2), (450999039, 'Stephan', 0, 1),
                     (452023582, 'Shumi', 2, 8), (452508632, '[ùìúùì≤ùìºùìΩùìÆùìªùìïùì∏ùîÅü¶ä]', 1, 22), (452809493, 'kis', 2, 2),
                     (455114833, 'TorqueDC', 0, 1), (458762980, '–ê–Ω–∞—Å—Ç–∞—Å–∏—è', 0, 2), (463377317, 'Mikhail', 0, 4),
                     (464673775, 'Irina', 0, 0), (466512605, '–°–µ—Ä–≥–µ–π', 0, 1), (467538482, 'Nikita', 0, 1),
                     (472752696, '–¢–æ–ª—Å—Ç—ã–π', 0, 7), (478216770, '–ù–∞—Ç–∞–ª—å—è', 1, 2), (480992547, '–î–∞—Ä—å—è', 0, 0),
                     (482208140, '–ë–æ—Ä–æ–¥–∏–Ω', 0, 15), (487799406, '–ü–µ—Ç—è', 14, 45),
                     (492217736, "ùìêùì∑ùì™ùìºùìΩùì™ùìºùì≤ùîÇùì™ ùì•ùì™ùìµùìÆùìª'ùìÆùìøùì∑ùì™", 3, 73), (497470748, '–ú–∞—Ä–∏–Ω–∞', 0, 49),
                     (499085576, "devyat'", 0, 3), (503060708, '1', 0, 4), (504871660, '...Paula rhei...üéê', 1, 5),
                     (505571937, 'Nastasya', 0, 2), (506306857, 'Georgy', 0, 14), (509876561, 'üß°Arishaüß°', 0, 3),
                     (509994617, 'Alina', 0, 0), (513046146, '–î–∞—Ä—å—è', 0, 4), (513180024, '–ú–∞–∫—Å–∏–º', 0, 8),
                     (517586856, '–ö–∏—Ä–∏–ª–ª', 0, 0), (527904649, '–Æ–ª–∏—è', 1, 3), (542907730, '–ê–ª—ë–Ω–∞', 0, 11),
                     (545713264, '771', 0, 0), (547455136, '–ê–ª—ë–Ω–∞üêä', 0, 5), (552152721, '–°–æ–Ω—è', 0, 0),
                     (557787540, '–í–∏–æ–ª–µ—Ç—Ç–∞', 1, 4), (562240635, 'Tatyana', 5, 1), (562516334, '–ê—Ä—Ç—É—Ä', 0, 0),
                     (564754403, '–ê–º–∏—Ä', 0, 2), (572989200, '–ú–∞—Ä–∏–Ω–∞', 0, 0), (606665721, '–î–∏–º–∞', 0, 0),
                     (613277648, 'Anzhela', 0, 0), (621934898, '–õ–∏–ª–∏—è', 0, 15), (627873994, '–ê—Ä—Ü—ë–º', 0, 1),
                     (636520654, 'ùêìùê¢ùêßùêö ùêÄùêßùêùùê´ùêûùêûùêØùêö-ùêé', 2, 0), (651754441, '–ú–∏—Ö–∞–∏–ª', 0, 2),
                     (652500168, 'Asomiddin', 0, 1), (678747037, 'Alisha', 0, 1), (683077544, '–ê–Ω–∞—Å—Ç–∞—Å–∏–∏', 0, 0),
                     (698289931, '–°–µ—Ä–≥–µ–π', 0, 5), (700154426, '–í–ª–∞–¥', 0, 14), (716919253, '–≠–ª–∏–Ω–∞', 2, 26),
                     (729749320, 'trud0v1k', 7, 1), (736544395, 'üçû', 0, 15), (738044196, '–ê–Ω–¥—Ä–µ–π', 3, 62),
                     (738058205, 'dani', 0, 2), (742029590, '–í–∏–∫—Ç–æ—Ä–∏—è', 0, 0), (742822451, '–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞', 11, 14),
                     (743581693, '–î–º–∏—Ç—Ä–∏–π', 0, 5), (747058877, '–ù–∞–¥–µ–∂–¥–∞', 0, 1), (749055897, '–ì–µ–æ—Ä–≥–∏–π', 0, 16),
                     (753026813, '–°–æ–≤–µ—Ç–Ω–∏–∫', 1, 0), (754651641, 'AZAR', 3, 7), (758273950, 'Feruza Davlatova', 0, 6),
                     (768917156, '–†—É—Å—Ç–∞–º', 0, 2), (769766400, '–í–∞–ª–µ—Ä–∏–π', 0, 0), (790334607, '–ü–∞–≤–µ–ª', 0, 11),
                     (792987498, '–°–≤–µ—Ç–ª–∞–Ω–∞', 0, 0), (795484607, 'MARINKA', 8, 30), (804147222, 'Dr1meR', 22, 9),
                     (808450301, 'Anna', 0, 17), (810466901, '–õ–∞—Ä–∏—Å–∞', 0, 3), (812290466, 'Pavel', 0, 2),
                     (816207036, '–ê–ª–µ–∫—Å–∞–Ω–¥—Ä', 0, 6), (816982069, '–ê–Ω–Ω–∞', 0, 2), (819326908, 'Alyona_mua', 0, 5),
                     (820005269, '–ü–∞–≤–µ–ª', 1, 0), (822117734, 'Volha', 1, 4), (830276013, 'KanT', 1, 3),
                     (834074217, '–ï–≤–≥–µ–Ω–∏–π', 0, 2), (834514861, '–ú–∞—Ä–∏—è', 0, 8), (836384755, '–°–∞—Ä–¥–æ—Ä', 0, 25),
                     (839648035, '–ò–ª—å—è—Å', 1, 13), (841609828, '–î–∞–º–∏—Ä', 3, 21), (841907397, '–ö—Ä–∏—Å—Ç–∏–Ω–∞', 0, 4),
                     (851029866, '–í–∏–∫—Ç–æ—Ä–∏—è', 0, 27), (858146666, 'Cokie', 0, 17), (859660894, 'Nastyakimchaka', 1, 45),
                     (859749651, 'Spiffero', 0, 0), (861869435, 'D', 0, 19), (862799911, '–ê–ª–∏–Ω–∞', 0, 6),
                     (863277792, '–ú–∞—Ä–∏', 0, 7), (867461858, 'Reiko', 1, 65), (867860623, 'Shura', 2, 4),
                     (868910613, '–¢–∞—Ç—å—è–Ω–∞', 0, 1), (868997804, 'Margaret', 0, 0), (869317966, '–ê–Ω—è', 0, 1),
                     (871420315, '–¢–∏—Ö–æ–Ω–æ–≤ –î–º–∏—Ç—Ä–∏–π', 4, 26), (881257675, '–ê—Ä—Ç—ë–º‚Ä¶', 0, 10), (893553727, '–ù–∞–¥–µ–∂–¥–∞', 0, 12),
                     (893659302, '–ï–ª–µ–Ω–∞', 3, 2), (895846256, 'Teodor', 1, 4), (901063586, '–°–∞—à–∫–∞', 0, 1),
                     (908805370, 'Emir', 1, 26), (916561409, 'aidanaaaaü¶Ñ', 0, 6), (924526817, 'Anastasia', 0, 10),
                     (929975356, 'Andre–π', 1, 0), (946586694, 'Lalisa', 0, 21), (951155830, 'Dinka', 1, 5),
                     (977343352, 'kkeeyyjj', 0, 1), (987237518, '–ú–∞–∫—Å–∏–º', 0, 2), (990092109, 'Gapanovich', 7, 31),
                     (991565082, 'Sotimjonov Ibrohim', 0, 2), (997565768, '–ü–∞–≤–µ–ª –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á', 0, 6),
                     (1000676110, 'quiquur ü¶ä', 0, 4), (1003340837, 'Alexander', 0, 19), (1012764851, 'Abzal', 0, 4),
                     (1023154935, 'Chisato', 0, 12), (1024863420, '–ê–Ω–∞—Å—Ç–∞—Å–∏—è', 0, 0), (1024898788, '–õ—ë–ª–∏–∫ ‚ôèÔ∏è', 0, 11),
                     (1030520433, '–ê–Ω—è', 0, 28), (1030955426, 'koti', 0, 0), (1032073048, 'Pavel', 0, 6),
                     (1035565331, 'blckclvr', 0, 2), (1036185431, 'Alisa', 0, 0), (1045573696, 'Nastya', 0, 93),
                     (1055533050, '–≠–≤–µ–ª–∏–Ω–∞', 0, 1), (1056995945, '–ú–∞—Ä–∏–Ω–∞', 0, 3), (1059418977, '–ú–∏—Ö–∞–∏–ª', 3, 46),
                     (1070343129, '–Ø–Ω–∞', 0, 11), (1071508014, '–í–∏–∫—Ç–æ—Ä', 0, 0), (1073279148, '–í–ª–∞–¥–∏–º–∏—Ä', 1, 20),
                     (1077099008, '–ì–æ—Ä–±–µ–Ω–∫–æ –í–µ—Ä–∞ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–Ω–∞', 0, 0), (1087968824, 'Group', 0, 14),
                     (1101789193, '–ü–∞—à–∫–∞', 0, 32), (1105980241, 'Gidro', 0, 7), (1107075338, '–ê–Ω–Ω–∞', 6, 5),
                     (1140315836, '.', 0, 0), (1143662930, '–î–æ–º–æ–≤—ë–Ω–æ–∫', 2, 3), (1151684762, '–ù–∞—Ç–∞–ª—å—è', 0, 1),
                     (1154589307, 'Roman', 0, 12), (1155561380, '–°–µ—Ä–≥–µ–π', 0, 0), (1170974327, '–ê–Ω–∞—Å—Ç–∞—Å–∏—è', 0, 7),
                     (1210746407, '–û–ª—å–≥–∞ –†.', 0, 3), (1229645234, 'Viktor', 3, 81), (1278180554, '–ê–ª–µ–∫—Å–µ–π', 0, 0),
                     (1293784911, '–ú–∞—Ä–∏—è', 1, 15), (1305289005, 'Alina', 1, 14), (1307681407, '–ú–µ—Ä–µ–π', 1, 2),
                     (1308607569, '–°–µ—Ä–≥–µ–π', 0, 9), (1318361058, 'Tryha', 0, 8), (1336366361, '–ê–Ω–¥—Ä–µ–π', 7, 83),
                     (1339241834, '–º–∞–º–∏–º–∞—è', 0, 1), (1342048804, '–ï—Ä–∫–µ–±“±–ª–∞–Ω', 0, 1), (1400614739, '–ú–∞—Ä–∏—è', 0, 4),
                     (1410693377, '–°–æ—Ñ–∏—è', 0, 2), (1413410130, 'Tatyana', 0, 1), (1461672197, 'Mikhass', 2, 6),
                     (1465418330, 'Egrty', 10, 68), (1474908137, 'shxwtyglock', 0, 9), (1522544993, '–ú–∞—Ä–≥–∞—Ä–∏—Ç–∞', 0, 0),
                     (1538788868, '–ú–∞—Ä–∏—è', 0, 0), (1548878319, '–í–∏–∫—Ç–æ—Ä–∏—è', 0, 33), (1610428181, '–ê–Ω–∞—Å—Ç–∞—Å–∏—è', 0, 0),
                     (1614353940, 'Cerry', 0, 5), (1620532528, 'Anton', 0, 7), (1634256266, '–û–ª—å–≥–∞ –ù–∏–∫–æ–ª–∞–µ–≤–Ω–∞', 0, 0),
                     (1648260796, 'H', 4, 67), (1674013125, '–°–∞—à–∞', 0, 23), (1689125526, 'Irina', 2, 2),
                     (1707650907, '–í–∏–∫—Ç–æ—Ä', 14, 29), (1714188977, 'mel0man.mp3', 0, 5), (1714460227, '–ù–∞—Ç–∞–ª—å—è', 0, 3),
                     (1716906410, '–¢–∞—Ç—å—è–Ω–∞', 0, 9), (1743718204, 'Igor', 0, 4), (1755312659, '–î–º–∏—Ç—Ä–∏–π', 0, 61),
                     (1760680218, 'q', 0, 10), (1801896420, 'T–∞–Ω—è', 2, 3), (1806325548, '–°–≤–µ—Ç–ª–∞–Ω–∞', 0, 7),
                     (1821113895, 'ùêâùê®ùêßùê¢ùêõùêûùê§..ùêÉùêöùêØùê´ùê®ùêßùê®ùêØùê¢ùêúùê°', 1, 12), (1860991679, 'Marina', 0, 2),
                     (1865883994, '–ù–∞—Ç–∞–ª—å—è', 0, 6), (1876326853, 'rein.', 0, 33), (1887739986, 'Olga', 0, 0),
                     (1909340513, '–û–ª—å–≥–∞', 0, 1), (1909782209, '–ê–Ω–Ω–∞', 0, 3), (1912808557, '–ì–∞—Ñ—É—Ä–æ–≤ –°–∞—Ä–≤–∞—Ä ¬≤‚Å∞', 0, 20),
                     (1922919123, 'Inna-Monika', 1, 35), (1960424178, 'Areg', 1, 3), (2071190232, '–ë–∏–±—Ä–∏–∫', 0, 12),
                     (2075764121, 'ùñóùñîùñûùñÜùñëùñäùñàùñÜùñôùñä', 0, 76), (2081243653, '–ê–Ω–¥—Ä–µ–π', 0, 2),
                     (2088342016, '–ú–∏—à–∞–Ω—è', 0, 0), (5060922561, '–ú–∞—à—É–ª—å–∫–∞üíñ', 0, 4), (5068133311, 'SaveliY üåÄ', 0, 0),
                     (5086313009, '–ò–º—è', 0, 27), (5086742583, '–î–º–∏—Ç—Ä–∏–π', 5, 11), (5112102053, 'Pawe≈Ç', 4, 0),
                     (5132976428, '–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∏–Ω–∞', 0, 2), (5198702853, '–ò–≥–æ—Ä—å', 0, 0),
                     (5198905388, 'konovalovapolinka250510', 0, 1), (5205705062, '–ï–ª–µ–Ω–∞ –ê.', 0, 1),
                     (5209216304, 'TheLisenok', 0, 0), (5294068026, 'line breaks', 0, 7),
                     (5303000503, '–ñ–∞–∫ –§—Ä–µ—Å–∫–æ', 0, 5), (5317391117, '∆ù ù”ÑŒ±', 0, 33), (5415508614, 'Gafurov', 0, 16),
                     (5459464220, '–ü–∞–≤–µ–ª', 0, 2), (5477288909, 'Kulll', 0, 0), (5512111160, 'Rino', 0, 9),
                     (5592557210, '–û–ª–µ–≥', 0, 7), (5594654032, '–ò—Ä–∏–Ω–∞', 0, 11), (5649460583, 'UMURZOQXON', 0, 19),
                     (5712619682, 'Sonnelon', 3, 4), (5715859430, '–ê–Ω—Ç–æ–Ω', 0, 7), (5754294473, '–°—É—â–∏–π', 0, 4),
                     (5772528979, 'La rahata fit dunya . . .ü•Ä', 0, 14), (5786113308, '–ú–∏—Ö–∞–∏–ª', 3, 6),
                     (5793476436, '–º–∞–∫–≤–∏–Ωüöó', 0, 2), (5846455614, 'UMURZOQXON', 0, 8), (5893297540, '04', 0, 14),
                     (5900739609, '–ù–∞—Ç–∞–ª—å—è', 0, 8), (5910911359, '–ú–∞–∫—Å–∏–º', 0, 0), (5917097298, 'Vor', 0, 18),
                     (5955070161, 'Memories never die', 0, 1), (6117758931, 'ùêâùê®ùêßùê¢ùêõùêûùê§', 0, 11),
                     (6236679739, '.', 0, 9)]
        for this_user in all_users:
            try:
                await db_users.add_user(this_user[0], 'None', this_user[1], this_user[2], this_user[3])
            except Exception as error:
                print(error)
        print('done')
    except Exception as error:
        await message.answer(unknown_error_answer)
        await log_all('stat', 'error', message.from_user.id, message.from_user.first_name, error)
